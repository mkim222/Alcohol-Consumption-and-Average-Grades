---
title: "Alcohol consumption and average grades"
author: "Minsoo KIm and Daemo Guo"
date: '2022-07-16'
output:
  html_document: default
  pdf_document: default
---

```{r}
library(readr)
student_mat <- read_csv("student-mat.csv")
View(student_mat)
```

```{r}
student_mat_revised <- student_mat %>%
  select(school, sex, age, studytime, failures, Dalc, Walc, absences, G3)
```

```{r}
student_mat_revised_2 <- student_mat_revised %>% 
  rename(
    weekdayalc = "Dalc",
    weekendalc = "Walc",
    grade = "G3",
  )
```

```{r}
student_mat_revised_3 <- student_mat_revised_2 %>% 
mutate(alcohol = weekdayalc + weekendalc) %>% 
  select(-weekdayalc, -weekendalc) %>% 
  filter(school == "GP")
```

```{r}
student_mat_revised_3 %>% 
  ggplot() +
  geom_bar(mapping = aes(x = sex, fill = sex))
```


```{r}
library(plotly)
fig <- student_mat_revised_3 %>% 
  ggplot() +
  geom_bar(mapping = aes(x = sex, fill = sex))

ggplotly(fig)
```

```{r}
a <- student_mat_revised_3 %>% 
  ggplot() +
  geom_smooth(mapping = aes(x = alcohol, y = grade), method = lm, se = FALSE, col = "blue", size = 3) +
  
  labs(
    title = "relationship",
    x = "alcohol",
    y = "grade"
  )
ggplotly(a)
```

```{r}
b <- student_mat_revised_3 %>% 
  ggplot() +
  geom_smooth(mapping = aes(x = alcohol, y = absences), method = lm, se = FALSE, col = "blue", size = 3) +
  
  labs(
    title = "relationship",
    x = "alcohol",
    y = "absences"
  )
ggplotly(b)
```

```{r}
c <- student_mat_revised_3 %>% 
  ggplot() +
  geom_smooth(mapping = aes(x = alcohol, y = studytime), method = lm, se = FALSE, col = "blue", size = 3) +
  
  labs(
    title = "relationship",
    x = "alcohol",
    y = "absences"
  )
ggplotly(c)
```

```{r}
d <- student_mat_revised_3 %>% 
  ggplot() +
  geom_smooth(mapping = aes(x = alcohol, y = failures), method = lm, se = FALSE, col = "blue", size = 3) +
  labs(
    title = "relationship",
    x = "alcohol",
    y = "failures"
  )
ggplotly(d)
```

```{r}
library(gganimate)
library(ggplot2)
library(dplyr)
library(ggthemes)
library(tidyr)
library(zoo)
```




