---
title: "Alcohol consumption and average grades"
author: "Minsoo KIm and Daemo Guo"
date: '2022-07-16'
output:
  html_document: default
  pdf_document: default
---

```{r}
# install packages
install.packages("googleVis")
install.packages("tidyverse")
install.packages("DT")
install.packages("flextable")
install.packages("ggplot2")
install.packages("gganimate")
install.packages("gapminder")
install.packages("maptools")
install.packages("plotly")
install.packages("leaflet")
# install klippy for copy-to-clipboard button in code chunks
install.packages("remotes")
remotes::install_github("rlesur/klippy")
```

```{r}
# set options
options(stringsAsFactors = F)          # no automatic data transformation
options("scipen" = 100, "digits" = 12) # suppress math annotation
# Warning: the following option adaptation requires re-setting during session outro!
op <- options(gvis.plot.tag='chart')  # set gViz options
# activate packages
library(googleVis)
library(tidyverse)
library(DT)
library(flextable)
library(ggplot2)
library(gganimate)
library(gapminder)
library(maptools)
library(plotly)
library(leaflet)
# activate klippy for copy-to-clipboard button
klippy::klippy()
```

```{r}
library(readr)
student_mat <- read_csv("student-mat.csv")
View(student_mat)
```

```{r}
student_mat_revised <- student_mat %>%
  select(school, sex, age, studytime, failures, Dalc, Walc, absences, G3)
```

```{r}
student_mat_revised_2 <- student_mat_revised %>% 
  rename(
    weekdayalc = "Dalc",
    weekendalc = "Walc",
    grade = "G3",
  )
```

```{r}
student_mat_revised_3 <- student_mat_revised_2 %>% 
mutate(alcohol = weekdayalc + weekendalc) %>% 
  select(-weekdayalc, -weekendalc)
```

```{r}
library(plotly)
library(tidyverse)
```

```{r}
fig <- student_mat_revised_3 %>% 
  plot_ly(x = ~alcohol, y = ~grade, type = "scatter", mode = "markers",
          hoverinfo = "text",
          text = paste("Alcohol consumption a week:", student_mat_revised_3$alcohol,
                       "<br>",
                       "Final grade:", student_mat_revised_3$grade))+
          
layout(
  title = "alcohol vs grade",
  xaxis = list(title = "alcohol"),
  yaxis = list(title = "grade"))

fig
```

